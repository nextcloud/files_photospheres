/**
 * Minified by jsDelivr using Terser v5.17.1.
 * Original file: /npm/@photo-sphere-viewer/stereo-plugin@5.1.6/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("three"),require("@photo-sphere-viewer/core"),require("@photo-sphere-viewer/gyroscope-plugin")):"function"==typeof define&&define.amd?define(["exports","three","@photo-sphere-viewer/core","@photo-sphere-viewer/gyroscope-plugin"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).PhotoSphereViewer=e.PhotoSphereViewer||{},e.PhotoSphereViewer.StereoPlugin={}),e.THREE,e.PhotoSphereViewer,e.PhotoSphereViewer.GyroscopePlugin)}(this,(function(e,t,i,s){
/*!
 * PhotoSphereViewer.StereoPlugin 5.1.6
 * @copyright 2023 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */
"use strict";var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,h=(e,t)=>{for(var i in t)r(e,i,{get:t[i],enumerable:!0})},l=()=>i,c={};h(c,{StereoPlugin:()=>S,events:()=>u});var p=l(),u={};h(u,{StereoUpdatedEvent:()=>w});var d=l(),v=class extends d.TypedEvent{constructor(e){super(v.type),this.stereoEnabled=e}},w=v;w.type="stereo-updated";var g=l(),k=class extends g.AbstractButton{constructor(e){super(e,{className:"psv-stereo-button",icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -2 16 16"><path fill="currentColor" d="M13.104 0H2.896C2.332 0 1 .392 1 .875h14C15 .392 13.668 0 13.104 0zM15 1H1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h3.534a2 2 0 0 0 1.821-1.172l1.19-2.618a.5.5 0 0 1 .91 0l1.19 2.618A2 2 0 0 0 11.466 11H15a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM4 7a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm8 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z"/>\x3c!--Created by Idev√£ Batista from the Noun Project--\x3e</svg>',hoverScale:!0,collapsable:!0,tabbable:!0}),this.plugin=this.viewer.getPlugin("stereo"),this.plugin&&this.plugin.addEventListener(w.type,this)}destroy(){this.plugin&&this.plugin.removeEventListener(w.type,this),super.destroy()}isSupported(){return!!this.plugin&&{initial:!1,promise:this.plugin.isSupported}}handleEvent(e){e instanceof w&&this.toggleActive(e.stereoEnabled)}onClick(){this.plugin.toggle()}};k.id="stereo";var y=l(),m=t,f="pleaseRotate",S=class extends y.AbstractPlugin{constructor(e){super(e),this.state={enabled:!1,wakeLock:null}}get isSupported(){return this.gyroscope.isSupported()}init(){if(super.init(),this.markers=this.viewer.getPlugin("markers"),this.compass=this.viewer.getPlugin("compass"),this.gyroscope=this.viewer.getPlugin("gyroscope"),!this.gyroscope)throw new y.PSVError("Stereo plugin requires the Gyroscope plugin");this.viewer.addEventListener(y.events.StopAllEvent.type,this),this.viewer.addEventListener(y.events.ClickEvent.type,this)}destroy(){this.viewer.removeEventListener(y.events.StopAllEvent.type,this),this.viewer.removeEventListener(y.events.ClickEvent.type,this),this.stop(),delete this.markers,delete this.compass,delete this.gyroscope,super.destroy()}handleEvent(e){(e instanceof y.events.StopAllEvent||e instanceof y.events.ClickEvent)&&this.stop()}isEnabled(){return this.state.enabled}start(){return this.viewer.enterFullscreen(),this.__startWakelock(),this.__lockOrientation(),this.gyroscope.start("fast").then((()=>{this.viewer.renderer.setCustomRenderer((e=>new class{constructor(e){const t=new m.StereoCamera;t.aspect=.5;const i=new m.Vector2;this.setEyeSeparation=function(e){t.eyeSep=e},this.setSize=function(t,i){e.setSize(t,i)},this.render=function(s,r){!0===s.matrixWorldAutoUpdate&&s.updateMatrixWorld(),null===r.parent&&!0===r.matrixWorldAutoUpdate&&r.updateMatrixWorld(),t.update(r),e.getSize(i),e.autoClear&&e.clear(),e.setScissorTest(!0),e.setScissor(0,0,i.width/2,i.height),e.setViewport(0,0,i.width/2,i.height),e.render(s,t.cameraL),e.setScissor(i.width/2,0,i.width/2,i.height),e.setViewport(i.width/2,0,i.width/2,i.height),e.render(s,t.cameraR),e.setScissorTest(!1)}}}(e))),this.state.enabled=!0,this.markers?.hideAllMarkers(),this.compass?.hide(),this.viewer.navbar.hide(),this.viewer.panel.hide(),this.dispatchEvent(new w(!0)),this.viewer.notification.show({content:this.viewer.config.lang.stereoNotification,timeout:3e3})}),(()=>(this.__unlockOrientation(),this.__stopWakelock(),this.viewer.exitFullscreen(),Promise.reject())))}stop(){this.isEnabled()&&(this.viewer.renderer.setCustomRenderer(null),this.state.enabled=!1,this.markers?.showAllMarkers(),this.compass?.show(),this.viewer.navbar.show(),this.__unlockOrientation(),this.__stopWakelock(),this.viewer.exitFullscreen(),this.gyroscope.stop(),this.dispatchEvent(new w(!1)))}toggle(){this.isEnabled()?this.stop():this.start()}__startWakelock(){"wakeLock"in navigator?navigator.wakeLock.request("screen").then((e=>{this.state.wakeLock=e})).catch((()=>y.utils.logWarn("Cannot acquire WakeLock"))):y.utils.logWarn("WakeLock is not available")}__stopWakelock(){this.state.wakeLock&&(this.state.wakeLock.release(),this.state.wakeLock=null)}__lockOrientation(){let e;const t=()=>{window.innerHeight>window.innerWidth&&this.viewer.overlay.show({id:f,image:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M66.7 19a14 14 0 0 1 13.8 12.1l-3.9-2.7c-.5-.3-1.1-.2-1.4.3-.3.5-.2 1.1.3 1.4l5.7 3.9.6.2c.3 0 .6-.2.8-.4l3.9-5.7c.3-.5.2-1.1-.3-1.4-.5-.3-1.1-.2-1.4.3l-2.4 3.5A16 16 0 0 0 66.7 17c-.6 0-1 .4-1 1s.4 1 1 1zM25 15h10c.6 0 1-.4 1-1s-.4-1-1-1H25c-.6 0-1 .4-1 1s.4 1 1 1zm-6.9 30H16l-2 .2a1 1 0 0 0-.8 1.2c.1.5.5.8 1 .8h.2l1.7-.2h2.1c.6 0 1-.4 1-1s-.5-1-1.1-1zm10 0h-4c-.6 0-1 .4-1 1s.4 1 1 1h4c.6 0 1-.4 1-1s-.4-1-1-1zM84 45H55V16A11 11 0 0 0 44 5H16A11 11 0 0 0 5 16v68a11 11 0 0 0 11 11h68a11 11 0 0 0 11-11V56a11 11 0 0 0-11-11zM16 93c-5 0-9-4-9-9V53.2c.3-.1.6-.3.7-.6a9.8 9.8 0 0 1 2-3c.4-.4.4-1 0-1.4a1 1 0 0 0-1.4 0l-1.2 1.5V16c0-5 4-9 9-9h28c5 0 9 4 9 9v68c0 5-4 9-9 9H16zm77-9c0 5-4 9-9 9H50.3c2.8-2 4.7-5.3 4.7-9V47h29c5 0 9 4 9 9v28zM38.1 45h-4c-.6 0-1 .4-1 1s.4 1 1 1h4c.6 0 1-.4 1-1s-.5-1-1-1zm9.9 0h-4c-.6 0-1 .4-1 1s.4 1 1 1h4c.6 0 1-.4 1-1s-.4-1-1-1zm38 19c-.6 0-1 .4-1 1v10c0 .6.4 1 1 1s1-.4 1-1V65c0-.6-.4-1-1-1z"/>\x3c!--Created by Anthony Bresset from the Noun Project--\x3e</svg>',title:this.viewer.config.lang.pleaseRotate,text:this.viewer.config.lang.tapToContinue}),e&&(clearTimeout(e),e=null)};window.screen?.orientation?(window.screen.orientation.lock("landscape").then(null,(()=>t())),e=setTimeout((()=>t()),500)):t()}__unlockOrientation(){window.screen?.orientation?window.screen.orientation.unlock():this.viewer.overlay.hide(f)}};S.id="stereo",p.DEFAULTS.lang[k.id]="Stereo view",(0,p.registerButton)(k,"caption:right"),p.DEFAULTS.lang.stereoNotification="Tap anywhere to exit stereo view.",p.DEFAULTS.lang.pleaseRotate="Please rotate your device",p.DEFAULTS.lang.tapToContinue="(or tap to continue)",((e,t,i,s)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let h of n(t))a.call(e,h)||h===i||r(e,h,{get:()=>t[h],enumerable:!(s=o(t,h))||s.enumerable})})(r(e,"__esModule",{value:!0}),c)}));
//# sourceMappingURL=/sm/8c0587e8cb72e2afdf58ca1e97d521f27e0a8f6b36159d2d96ecedd4dda7d08f.map